(function() {
    function n() {
        window.urlServices.getDomains().then(n => {
            fetch(`${n.serverWeb}/user-management-service/api/v1/User/Logout`, {
                method: "GET",
                headers: {
                    Accept: "application/json",
                    "Content-Type": "application/json"
                }
            }).then(n => n.json()).then(n => {
                n && n.isSuccess && (localStorage && (localStorage.removeItem("SEARCHING_HISTORIES"), localStorage.removeItem("SEARCHING_HISTORIES_SYNC_TIME"), localStorage.removeItem("MARKED_PRODUCTS"), localStorage.removeItem("MARKED_PRODUCTS_SYNC_TIME"), localStorage.removeItem("MARKED_PRODUCT_IDS_SYNC_TIME")), window.location.reload(!0))
            })
        })
    }

    function t(n) {
        var t = "",
            i = "";
        n.accounttype ? t = `<span class="account-type">Tài khoản ${n.accounttype.toLowerCase()}</span>` : i = "lh40";
        let r = `
            <img src="${n.avatar}" alt="avatar">
            <div class="${window.styleServices.getStyleClass("avatar-text")} js__avatar-text" style="display: none;">
                ${window.styleServices.firstCharOfFirstName(n.name)}
            </div>`;
        return (!n.avatar || n.avatar.indexOf("default-user-avatar-blue") >= 0) && (r = `
            <div class="${window.styleServices.getStyleClass("avatar-text")}">
                ${window.styleServices.firstCharOfFirstName(n.name)}
            </div>`), `
        <div class="login-group ${i}">
            <div class="notification" style="width: unset;height: unset;">
                <bds-notification size="md" userId="${n.userid}" mode="mobile" class="${window.styleServices.getStyleClass("bds-notification")} js__bds-notification js__mobile-notification" ></bds-notification>
                <bds-notification size="md" userId="${n.userid}" class="${window.styleServices.getStyleClass("bds-notification")} js__bds-notification js__web-notification" ></bds-notification>
            </div>
            <style>
                .re__tablet-menu .js__web-notification { display: none;}
                .re__hover-menu .js__mobile-notification { display: none;}
            </style>
            <div class="text-name notify" style="width: calc(100% - 48px)">
                <div class="box-info">
                    <div class="login-avatar">
                        <a href="/trang-ca-nhan" rel="nofollow">
                            <div class="${window.styleServices.getStyleClass("avatar--xl")} js__avatar">
                                ${r}
                            </div>
                        </a>
                    </div>
                    <div class="login-info">
                        <a href="/trang-ca-nhan" rel="nofollow">${n.name}</a>${t}
                    </div>
                    <div class="login-icon">
                        <i class="${window.styleServices.getStyleClass("icon-chevron-down--sm")}"></i>
                    </div>
                </div>
                <ul class="${window.styleServices.getStyleClass("dropdown-art")}">
                    <li>
                        <a href="/trang-ca-nhan" class="${window.styleServices.getStyleClass("content")}">
                            <i class="${window.styleServices.getStyleClass("icon-listing-new--sm")}"></i><span>Quản lý tin đăng</span>
                        </a>
                    </li>
                    <li>
                        <a href="/sellernet/tin-tai-tro?source=Adtech_Click_TabbarTop" class="${window.styleServices.getStyleClass("content")} js__menu-ads-tool">
                            <i class="${window.styleServices.getStyleClass("icon-adsense--sm")}"></i><span>Quản lý tin tài trợ</span>
                        </a>
                    </li>
                    <li>
                        <a href="/trang-ca-nhan/uspg-changeinfo" class="${window.styleServices.getStyleClass("content")}">
                            <i class="${window.styleServices.getStyleClass("icon-user--sm")}"></i><span>Thay đổi thông tin cá nhân</span>
                        </a>
                    </li>
                    <li>
                        <a href="/trang-ca-nhan/uspg-changepass" class="${window.styleServices.getStyleClass("content")}">
                            <i class="${window.styleServices.getStyleClass("icon-lock--sm")}"></i><span>Thay đổi mật khẩu</span>
                        </a>
                    </li>
                    <li>
                        <a href="/sellernet/nap-tien" class="${window.styleServices.getStyleClass("content")}">
                            <i class="${window.styleServices.getStyleClass("icon-wallet--sm")}"></i><span>Nạp tiền</span>
                        </a>
                    </li>
                    <li class="${window.styleServices.getStyleClass("border-b")}"></li>
                    <li>
                        <a href="javascript:void(0);" class="js__logout-button ${window.styleServices.getStyleClass("content")}" rel="nofollow">
                            <i class="${window.styleServices.getStyleClass("icon-logout--sm")}"></i><span>Đăng xuất</span>
                        </a>
                    </li>
                </ul>
            </div>        
        </div>
        <style>
            .re__tablet-menu .login-info>a {
                max-width: 160px !important;
            }
            .re__hover-menu .login-info>a {
                max-width: 136px !important;
            }
        </style>`
    }

    function i(n) {
        function r() {
            var t = [],
                n;
            return localStorage && (n = localStorage.getItem("SEARCHING_HISTORIES"), n && (t = JSON.parse(n))), t
        }

        function u() {
            var n;
            if (localStorage && (n = localStorage.getItem("SEARCHING_HISTORIES_SYNC_TIME"), n)) return new Date(n)
        }

        function f(n, t) {
            return Math.round(n.getTime() - t.getTime()) / 6e4
        }

        function e() {
            var n = new Date;
            return n.toUTCString()
        }
        var t = u(),
            i;
        (t == null || t != null && f(new Date, t) >= (+document.querySelector(".searching-histories-configs[sync-time-searching-histories]").getAttribute("sync-time-searching-histories") || 5)) && (i = r(), n.userid && window.urlServices.getDomains().then(t => {
            if (document.querySelector(".searching-histories-configs[sync-searching-histories-url]")) {
                var r = document.querySelector(".searching-histories-configs[sync-searching-histories-url]").getAttribute("sync-searching-histories-url");
                fetch(`${t.msvrouter}${r}?userId=${n.userid}`, {
                    method: "POST",
                    headers: {
                        Accept: "application/json",
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify({
                        searchingHistories: i
                    })
                }).then(n => n.json()).then(function(n) {
                    if (localStorage) {
                        var t = JSON.stringify(n);
                        localStorage.setItem("SEARCHING_HISTORIES", t)
                    }
                })
            }
        }), localStorage && localStorage.setItem("SEARCHING_HISTORIES_SYNC_TIME", e()))
    }(function() {
        (function r() {
            window.userServices ? window.userServices.getCurrentUserInfo(function(r) {
                var f, u;
                r ? (f = 20, function e() {
                    --f;
                    window.GoogleOneTap ? window.GoogleOneTap.SendTracking(r) : f >= 0 && setTimeout(e, 100)
                }(), function() {
                    return new Promise(function() {
                        document.querySelectorAll(".searching-histories-configs").length && i(r)
                    })
                }(), document.getElementById(`nav_list`).querySelectorAll(`.re__notification`).length && document.addEventListener("bdsUnreadNotificationCount", function(n) {
                    if (n.detail.val) {
                        var t = n.detail.val.toString().length > 2 ? "99+" : n.detail.val;
                        document.querySelectorAll(`#nav_list .re__notification`).forEach(n => {
                            n.innerHTML = t, n.classList.remove(window.styleServices.getStyleClass("hide"))
                        })
                    } else document.querySelectorAll(`#nav_list .re__notification`).forEach(n => {
                        n.classList.add(window.styleServices.getStyleClass("hide"))
                    })
                }), document.getElementById("divUserStt").innerHTML = t(r), u = document.createElement("script"), u.setAttribute("type", "module"), u.setAttribute("src", document.getElementById("divUserStt").getAttribute("data-notification-library-url")), u.setAttribute("async", ""), u.setAttribute("defer", ""), document.body.append(u), document.querySelectorAll(".dropdown-navigative-menu li").forEach((n, t) => {
                    if (t == 0) {
                        var i = document.createElement("li");
                        i.classList.add("lv0");
                        i.classList.add("tablet");
                        i.innerHTML = `
                                <a href="/trang-ca-nhan">
                                    <span class="icon">
                                        <img src="${document.getElementById("staticDomain").getAttribute("data-cssserver")}/images/mobile/ic_personal_info.png /">
                                    </span>
                                    <span class="text">Trang cá nhân</span>
                                </a>`;
                        n.after(i)
                    }
                }), document.querySelectorAll(".dropdown-navigative-menu").forEach(n => {
                    var t = document.createElement("li");
                    t.classList.add("lv0");
                    t.classList.add("tablet");
                    t.classList.add("bg_menu");
                    t.classList.add("first-child");
                    t.innerHTML = `<a href="javascript:void(0);" class="js__logout-button" rel="nofollow">Đăng xuất</a>`;
                    n.append(t)
                }), document.querySelectorAll(".js__avatar").forEach(n => {
                    n.querySelectorAll("img").forEach(n => {
                        n.onerror = function() {
                            n.style.display = "none";
                            document.querySelectorAll(".js__avatar-text").forEach(n => n.removeAttribute("style"))
                        }
                    })
                }), document.getElementById(`linkPostProduct`).classList.add(`${window.styleServices.getStyleClass("login")}`), document.querySelectorAll(`.${window.styleServices.getStyleClass("home-header-menu")} .${window.styleServices.getStyleClass("dropdown-no-art--sm")}.${window.styleServices.getStyleClass("dropdown-navigative-menu")}`).forEach(n => {
                    var t = document.createElement("li");
                    t.classList.add("lv0");
                    t.classList.add("tablet");
                    t.classList.add("bg_menu");
                    t.classList.add("first-child");
                    t.innerHTML = `<a href="javascript:void(0);" class="js__logout-button">Đăng xuất</a>`;
                    n.append(t)
                }), document.querySelectorAll(`.${window.styleServices.getStyleClass("home-header-menu")} li.lv0.tablet`).forEach(n => {
                    n.classList.add(`${window.styleServices.getStyleClass("login")}`)
                }), function o() {
                    window.ResponsiveSizeScreen ? window.ResponsiveSizeScreen() : setTimeout(o, 500)
                }(), document.querySelectorAll(".js__logout-button").forEach(t => t.addEventListener("click", n)), document.querySelectorAll(".js__menu-ads-tool").forEach(n => {
                    n.addEventListener("click", function() {
                        window.dataLayer = window.dataLayer || [];
                        window.dataLayer.push({
                            event: "Adtech_Click_TabbarTop",
                            data: {}
                        })
                    })
                }), document.querySelectorAll(".banner-home-slide").forEach(n => {
                    n.addEventListener("click", function() {
                        document.querySelectorAll(`.text-name .${window.styleServices.getStyleClass("dropdown-art")}`).forEach(n => {
                            n.style.display = "none"
                        })
                    })
                }), document.querySelectorAll(".quick_notify").forEach(n => {
                    n.addEventListener("click", function() {
                        document.querySelectorAll(`#divUserStt .${window.styleServices.getStyleClass("notification")}`).forEach(n => n.classList.remove(`${window.styleServices.getStyleClass("actived")}`));
                        document.getElementById("notify_quick_view").remove();
                        document.querySelectorAll(".text-name ul").forEach(n => {
                            n.style.display = "none"
                        });
                        document.querySelectorAll(".quick_notify").forEach(n => {
                            n.classList.add("hidden")
                        });
                        document.querySelectorAll(".form-content").forEach(n => {
                            n.classList.remove("under-login-popup")
                        })
                    })
                }), document.querySelectorAll(".text-name").forEach(n => {
                    n.addEventListener("mouseenter", function(n) {
                        document.getElementById("divUserStt").contains(n.target) && (document.querySelectorAll(`#divUserStt .${window.styleServices.getStyleClass("notification")}`).forEach(n => {
                            n.classList.remove(`${window.styleServices.getStyleClass("actived")}`)
                        }), document.querySelector("header").classList.contains(`${window.styleServices.getStyleClass("tablet-menu")}`) || (document.querySelectorAll("#notify_quick_view").forEach(n => {
                            n.remove()
                        }), document.querySelectorAll(".quick_notify").forEach(n => {
                            n.classList.add("hidden")
                        })), document.querySelectorAll(".form-content").forEach(n => {
                            n.classList.remove("under-login-popup")
                        }), document.querySelectorAll(`.${window.styleServices.getStyleClass("marked-products-popup")}`).forEach(n => {
                            n.style.display = "none"
                        }), document.querySelectorAll(`.text-name .${window.styleServices.getStyleClass("dropdown-art")}`).forEach(n => {
                            n.style.display = "block"
                        }))
                    })
                }), document.querySelectorAll(".text-name").forEach(n => {
                    n.addEventListener("mouseleave", function(n) {
                        document.getElementById("divUserStt").contains(n.target) && document.querySelectorAll(`.text-name .${window.styleServices.getStyleClass("dropdown-art")}`).forEach(n => {
                            n.style.display = "none"
                        })
                    })
                })) : localStorage && (localStorage.getItem("SEARCHING_HISTORIES_SYNC_TIME") && (localStorage.removeItem("SEARCHING_HISTORIES"), localStorage.removeItem("SEARCHING_HISTORIES_SYNC_TIME")), localStorage.getItem("MARKED_PRODUCT_IDS_SYNC_TIME") && (localStorage.removeItem("MARKED_PRODUCTS"), localStorage.removeItem("MARKED_PRODUCTS_SYNC_TIME"), localStorage.removeItem("MARKED_PRODUCT_IDS_SYNC_TIME")))
            }) : setTimeout(r, 500)
        })()
    })()
})();