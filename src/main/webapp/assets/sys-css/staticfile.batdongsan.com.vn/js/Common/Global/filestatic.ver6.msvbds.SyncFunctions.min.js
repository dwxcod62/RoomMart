function waitObject(n, t = 20) {
    function i(t, r, u) {
        function o(n = 0) {
            return (f = f[e[n]], !f) ? !1 : n == e.length - 1 ? f : o(n + 1)
        }
        var e = n.split("."),
            f = window;
        o() ? t() : u - 1 ? setTimeout(function() {
            i(t, r, u - 1)
        }, 500) : r("loading object error")
    }
    return new Promise(function(n, r) {
        i(n, r, t)
    })
}

function waitObjects(n, t = 20) {
    return Promise.all(n.map(n => waitObject(n, t)))
}

function loadResource(n, t, i = 20) {
    (function r(i = 20) {
        waitObject(n, 1).then(() => {
            waitObject("loggingServices").then(() => {
                window.loggingServices.log(n + " loaded")
            });
            return
        }).catch(() => {
            if (i <= 0) {
                waitObject("loggingServices").then(() => {
                    window.loggingServices.log("loading " + n + " errors")
                });
                return
            }
            let u = document.createElement("script");
            u.setAttribute("src", t);
            u.setAttribute("type", "text/javascript");
            document.body.appendChild(u);
            u.remove();
            setTimeout(() => {
                r(i - 1)
            }, 500)
        })
    })(i)
}

function loadTiktokThumbnail() {
    if (this.tagName == "IMG") {
        var n = this,
            t = n.getAttribute("data-tiktok-link");
        if (t) {
            fetch(`https://www.tiktok.com/oembed?url=${t}`).then(n => n.status === 200 && n.json()).then(t => {
                n.src = t.thumbnail_url, document.querySelector(".js__tiktok-thumbnail-img-cover") && (document.querySelector(".js__tiktok-thumbnail-img-cover").style.backgroundImage = `url('${t.thumbnail_url}')`)
            });
            n.onload = undefined;
            return
        }
    }
}

function loadTiktokUrl() {
    if (this.tagName == "IFRAME") {
        var n = this,
            t = n.getAttribute("data-tiktok-link");
        if (t) {
            fetch(`https://www.tiktok.com/oembed?url=${t}`).then(n => n.status === 200 && n.json()).then(t => {
                n.src = `${t.provider_url}/embed/v2/${t.embed_product_id}?lang=vi-VN&embedFrom=oembed`
            });
            n.onload = undefined;
            return
        }
    }
}