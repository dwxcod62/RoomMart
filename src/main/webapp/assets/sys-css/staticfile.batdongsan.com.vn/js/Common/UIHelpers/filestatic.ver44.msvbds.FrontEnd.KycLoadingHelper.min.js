window.FrontEnd || (window.FrontEnd = {});
FrontEnd.KycLoadingHelper = function() {
    const n = "KYC_TRIGGER_TYPE_LOCAL_STORAGE_KEY_CACHE",
        t = $("#staticDomain").data("msvrouter") !== undefined ? $("#staticDomain").data("msvrouter") : "";
    (function() {
        localStorage && localStorage.getItem && localStorage.getItem(n) && window.$ && window.addEventListener("load", () => {
            function r() {
                return
            }

            function f(n) {
                var i = $("#staticDomain").data("cssserver"),
                    r = "";
                n.mobileSender && cm.AjaxWrapperWithPromise({
                    type: "POST",
                    url: t + $(".js__kyc-form-helper").data("form-rcb"),
                    data: {
                        type: "productcontact",
                        emailSeller: n.emailSeller,
                        mobileSender: n.mobileSender.trim(),
                        nameSender: n.nameSender.trim(),
                        nameSeller: n.nameSeller,
                        mobileSeller: n.mobileSeller,
                        userid: n.userId,
                        loginid: userInfo.userid,
                        content: n.content,
                        productid: n.productId,
                        platform: n.platform,
                        device: n.device,
                        referrer: document.referrer,
                        producturl: window.location.href,
                        formType: 3,
                        productType: n.productType
                    }
                }).then(function(t) {
                    $("body").removeClass("loading-body");
                    t.success ? r = $("#product-detail-wap").length > 0 ? `
                                    <div class="${cm.GetStyleClass("all-margin","form-RCB-success")} js__form-RCB-success">
                                        <div>
                                            <div class="${cm.GetStyleClass("col","text-center")} img-success">
                                                <img src="${i}/images/contacts/RCB-Success.svg">
                                            </div>
                                            <div class="${cm.GetStyleClass("col","text-info","text-center")}">
                                                <h3>Gửi thành công</h3>
                                                <p>Người đăng tin đã nhận được yêu cầu và sẽ sớm liên hệ lại cho bạn.</p>
                                            </div>
                                            <div class="${cm.GetStyleClass("col","text-info","form-RCB-info-user")}">
                                                <div class="${cm.GetStyleClass("title")}">Thông tin liên hệ:</div>
                                                <ul class="js__RCB-info-user-item">
                                                    <li class="full-name"><div><span>${n.nameSender}</span></div></li>
                                                    <li class="phone-number"><div><span>${n.mobileSender}</span></div></li>
                                                </ul>
                                            </div>
                                            <div class="${cm.GetStyleClass("col")}">
                                                <div class="submit-loading js__submit-loading width-full">
                                                    <a class="${cm.GetStyleClass("btn","btn-pr-solid--md")} js__form-RCB-success-login-close-popup-button-in-body">
                                                        OK
                                                    </a>
                                                    <a class="@Html.GetStyleClass("btn", "btn-pr-solid--md", "btn-icon--md") submit-loading-hover"
                                                        onmouseover="this.style.cursor='pointer'">
                                                        <i><img src="${i}/images/loading/loading-buffering_b_v2.svg" /></i>
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>` : `
                                    <div class="${cm.GetStyleClass("feature-web-popup","col-1","form-RCB-success")} js__form-RCB-success">
                                        <div>
                                            <div class="${cm.GetStyleClass("form-RCB-header")}">
                                                <div class="${cm.GetStyleClass("form-RCB-header-image")}">
                                                    <img src="${i}/images/contacts/RCB-Success.svg">
                                                </div>
                                                <div class="${cm.GetStyleClass("form-RCB-header-message")}">
                                                    <p>
                                                        Gửi thành công
                                                    </p>
                                                </div>
                                                <div class="${cm.GetStyleClass("form-RCB-header-submessage")}">
                                                    <p>
                                                        Người đăng tin đã nhận được yêu cầu và sẽ sớm liên hệ lại cho bạn.
                                                    </p>
                                                </div>
                                                <div class="${cm.GetStyleClass("form-RCB-info-user")}">
                                                    <div class="${cm.GetStyleClass("title")}">Thông tin liên hệ:</div>
                                                    <ul class="js__RCB-info-user-item">
                                                        <li class="full-name"><div><span>${n.nameSender}</span></div></li>
                                                        <li class="phone-number"><div><span>${n.mobileSender}</span></div></li>
                                                    </ul>
                                                </div>
                                            </div>
                                            <div class="${cm.GetStyleClass("form-group","p-footer")}">
                                                <div class="submit-loading js__submit-loading width-full">
                                                    <button class="${cm.GetStyleClass("btn","btn-pr-solid--md")} js__form-RCB-success-login-close-popup-button-in-body">
                                                        OK
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>` : (r = $("#product-detail-wap").length > 0 ? `
                                    <div class="${cm.GetStyleClass("all-margin","form-RCB-success")} js__form-RCB-success">
                                        <div>
                                            <div class="${cm.GetStyleClass("col","text-center")} img-success">
                                                <img src="${i}/images/contacts/not-send.svg">
                                            </div>
                                            <div class="${cm.GetStyleClass("col","text-info","text-center")}">
                                                <h3> Rất tiếc, đã có lỗi xảy ra</h3>
                                                <p>Vui lòng kiểm tra và thử lại.</p>
                                            </div>
                                            <div class="${cm.GetStyleClass("col")}">
                                                <div class="submit-loading js__submit-loading width-full">
                                                    <a class="${cm.GetStyleClass("btn","btn-pr-solid--md")} js__form-RCB-success-login-close-popup-button-in-body">
                                                        OK
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>` : `
                                    <div class="${cm.GetStyleClass("feature-web-popup","col-1","form-RCB-success")} js__form-RCB-success">
                                        <div>
                                            <div class="${cm.GetStyleClass("form-RCB-header")}">
                                                <div class="${cm.GetStyleClass("form-RCB-header-image")}">
                                                    <img src="${i}/images/contacts/not-send.svg">
                                                </div>
                                                <div class="${cm.GetStyleClass("form-RCB-header-message")}">
                                                    Rất tiếc, đã có lỗi xảy ra
                                                </div>
                                                <div class="${cm.GetStyleClass("form-RCB-header-submessage")}">
                                                    Vui lòng kiểm tra và thử lại
                                                </div>
                                            </div>
                                            <div class="${cm.GetStyleClass("form-group","p-footer")}">
                                                <div class="submit-loading js__submit-loading width-full">
                                                    <button class="${cm.GetStyleClass("btn","btn-pr-solid--md")} js__form-RCB-success-login-close-popup-button-in-body">
                                                        OK
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>`, e("RCB-fail", "RCB"));
                    let u = {
                        classModalDialog: n.classModalDialog,
                        classContent: `new2021 form-col-1 re__rcb-kyc js__kyc-login-form re__form-RCB-success-mode`,
                        classHeader: `modal-header re__kyc-popup-header`,
                        classFooter: `modal-footer re__kyc-popup-footer`,
                        disableNomodal: !0,
                        content: r,
                        style: "static",
                        title: "",
                        width: 464,
                        keepBodyScroll: !1
                    };
                    cm.ShowDialog(u)
                })
            }

            function e(n, t, i) {
                window.SegmentClient && i.productId && window.SegmentClient.LeadRequestCallBack(parameters.productId)
            }
            let i = JSON.parse(localStorage.getItem(n));
            (localStorage.removeItem(n), i) && (function u(n) {
                if (!window.userServices && n) {
                    setTimeout(() => {
                        u(n - 1)
                    }, 500);
                    return
                }
                window.userServices.getCurrentUserInfo(function(n) {
                    var c, l;
                    if (n) {
                        var t = i.elementSelector,
                            o = i.triggerPage,
                            e = i.triggerType,
                            s = i.triggerViewMore,
                            u = i.triggerPositionTop,
                            a = i.triggerPositionLazyload,
                            v = i.elementId,
                            h = i.agent,
                            y = i.product;
                        r($(i.elementSelector));
                        $(i.elementSelector).length > 1 && (t = i.elementSelector + ":last-child");
                        window.SegmentClient && window.SegmentClient.Identify();
                        e == "click" ? (r($(t)), $(t).click(), i.scrollContentTop && (c = 5, function p() {
                            --c;
                            var n = document.documentElement.scrollTop;
                            n != u && ($(window).scrollTop(u), c >= 0 && n != u && setTimeout(p, 1500))
                        }())) : e == "clickPhone" ? ($(".js__phone-event").length > 0 && $(".js__phone-event").attr("tracking-kyc", "true"), s && s != "" ? function w() {
                            $(window).scrollTop(a);
                            $(".js__kyc-product-view-more").length > 0 ? function i() {
                                s && ($(".js__kyc-product-view-more").attr("class").search("on") >= 0 ? function f() {
                                    if (r($(t)), $(t).data("click")) {
                                        $(window).scrollTop(u);
                                        return
                                    }
                                    if (window.SegmentClient && v && window.SegmentClient.LeadPhone(v), h && window.FrontEnd && window.FrontEnd.LeadManagementServices) {
                                        let t = new window.FrontEnd.LeadManagementServices;
                                        var i = {
                                            userId: n.userid,
                                            mobile: n.mobile,
                                            sellerId: h.userId,
                                            productId: h.productId,
                                            productType: 0,
                                            leadSourceAction: t.LeadSourceAction.PHONE_REVEAL,
                                            leadSourcePage: h.leadSourcePage,
                                            fromLeadType: t.FromLeadType.PhoneReveal
                                        };
                                        t.CreateLead(i)
                                    }
                                    r($(t));
                                    $(t).click();
                                    setTimeout(f, 1e3)
                                }() : ($(".js__kyc-product-view-more").attr("class").search("on") < 0 && $(".js__kyc-product-extend").click(), setTimeout(i, 500)))
                            }() : setTimeout(w, 500)
                        }() : s == "" && o < 1 ? ($(window).scrollTop(a), function b() {
                            $(t).length > 0 ? function n() {
                                if (r($(t)), $(t).data("click")) {
                                    $(window).scrollTop(u);
                                    return
                                }
                                r($(t));
                                $(t).click();
                                setTimeout(n, 1e3)
                            }() : setTimeout(b, 500)
                        }()) : o ? (l = 0, function d() {
                            o >= 2 ? (function n() {
                                $(".js__click-load-page").data("click") || ($(".js__product-listing .js__card").length <= 20 && $(".js__click-load-page").click(), setTimeout(n, 200))
                            }(), o == 2 ? function i() {
                                var n = $(".js__product-listing .js__card").length;
                                n > 20 && n <= 40 ? function f() {
                                    if ($(t).data("click")) {
                                        $(window).scrollTop(u);
                                        return
                                    }
                                    if ($(t).length == 0) {
                                        $(window).scrollTop(0);
                                        return
                                    }
                                    r($(t));
                                    $(t).click();
                                    setTimeout(f, 1500)
                                }() : setTimeout(i, 300)
                            }() : (function f() {
                                var n = $(".js__product-listing .js__card").length;
                                n > 20 && n <= 40 ? function t() {
                                    $(".js__click-load-page").data("clickpage2") || (n > 20 && n <= 40 && $(".js__click-load-page").click(), setTimeout(t, 500))
                                }() : setTimeout(f, 500)
                            }(), function e() {
                                countItem = $(".js__product-listing .js__card").length;
                                countItem > 40 && countItem <= 60 ? function n() {
                                    if ($(t).data("click")) {
                                        $(window).scrollTop(u);
                                        return
                                    }
                                    if ($(t).length == 0) {
                                        $(window).scrollTop(0);
                                        return
                                    }
                                    r($(t));
                                    $(t).click();
                                    setTimeout(n, 1500)
                                }() : setTimeout(e, 500)
                            }())) : $(t).length > 0 && function s() {
                                if ($(t).data("click")) {
                                    $(window).scrollTop(u);
                                    return
                                }
                                if ($(t).length == 0) {
                                    $(window).scrollTop(0);
                                    return
                                }
                                document.querySelectorAll(t).length && (r($(t)), document.querySelectorAll(t)[0].dispatchEvent(new Event("click")));
                                setTimeout(s, 1500)
                            }();
                            l++;
                            l < 3 && setTimeout(d, 500)
                        }()) : function k() {
                            if ($(t).attr("mobile")) {
                                $(window).scrollTop(u);
                                return
                            }
                            r($(t));
                            $(t).click();
                            setTimeout(k, 1500)
                        }()) : e == "clickReturn" ? function g() {
                            if (!$(t).data("click")) {
                                if (r($(t)), $(t).click(), i.scrollContentTop) {
                                    var n = 5;
                                    (function f() {
                                        --n;
                                        var t = document.documentElement.scrollTop;
                                        t != u && ($(window).scrollTop(u), n >= 0 && t != u && setTimeout(f, 1500))
                                    })()
                                }
                                i.scrollContentTop && $(window).scrollTop(u);
                                setTimeout(g, 1500)
                            }
                        }() : e == "scrollReturn" ? $(window).scrollTop(u) : e == "scrollToElement" ? function nt(n) {
                            let t = document.querySelector(i.elementSelector) ? document.querySelector(i.elementSelector).offsetTop : 0;
                            t ? function r(n) {
                                Math.round(window.scrollY) != t && (window.scrollBy(0, t - Math.round(window.scrollY)), n <= 0 && console.error("scroll error"), setTimeout(() => {
                                    r(n - 1)
                                }, 500))
                            }(20) : n > 0 && setTimeout(() => {
                                nt(n - 1)
                            }, 500)
                        }(20) : e == "rcbSuccess" && ($(window).scrollTop(u), f(y));
                        i.source == "loginForm" && (window.dataLayer = window.dataLayer || [], window.dataLayer.push({
                            event: "kyc.loginSucceeded",
                            source: i.source
                        }))
                    }
                })
            }(20), function o() {
                $(".js__kyc-login-form").find(".js__form-RCB-success").length == 1 ? $(".js__kyc-login-form").find(".js__form-RCB-success-login-close-popup-button-in-body").click(function() {
                    $(".js__kyc-login-form .close").click()
                }) : setTimeout(o, 500)
            }())
        })
    })()
};