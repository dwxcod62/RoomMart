(function(n) {
    (function(n) {
        (function t(n) {
            window.jQuery ? n.Details = function(n) {
                function v() {
                    (document.querySelector("div.js__li-other") === null || document.querySelector("div.js__li-other") === undefined) && document.querySelector("div.js__similar-listing") && document.querySelector("div.js__similar-listing").classList.add("js__li-other");
                    $(window).scroll(function() {
                        if (u != 1) {
                            var n = $(window).scrollTop(),
                                t = $(".js__pr-scrollbar").outerHeight() + 20,
                                i = $(".js__li-description").length ? $(".js__li-description").offset().top - t : null,
                                f = $(".js__li-specs").length ? $(".js__li-specs").offset().top - t : null,
                                e = $(".js__ldp-location-insight").length ? $(".js__ldp-location-insight").offset().top - t : null,
                                o = $(".js__li-pricing-history-chart").length ? $(".js__li-pricing-history-chart").offset().top - t : null,
                                s = $(".js__li-other").length ? $(".js__li-other").offset().top - t : null;
                            i != null && n < i && $(".js__pr-scrollbar li").removeClass("item-current");
                            i != null && n >= i && r("description");
                            f != null && n >= f && r("specs");
                            e != null && n >= e && r("location-insight");
                            o != null && n >= o && r("pricing-history-chart");
                            s != null && n >= s && r("other")
                        }
                    })
                }

                function r(n) {
                    $(".js__pr-scrollbar li").removeClass("item-current");
                    $("li.js__li-" + n).addClass("item-current")
                }

                function c() {
                    $(".js__pr-scrollbar li").removeClass("item-current");
                    $(".js__pr-scrollbar .js__li-location-insight").addClass("item-current");
                    var t = $(".js__pr-scrollbar").outerHeight() + 15;
                    let n = $(`.js__ldp-location-insight`);
                    if (n.length) return $("html, body").animate({
                        scrollTop: n.offset().top - t
                    }, 1e3, "easeInOutExpo", function() {}), !1
                }

                function y() {
                    $('.js__pr-scrollbar a[href*="#"]:not([href="#"])').click(function() {
                        if (location.pathname.replace(/^\//, "") == this.pathname.replace(/^\//, "") && location.hostname == this.hostname) {
                            $(".js__pr-scrollbar li").removeClass("item-current");
                            $(this).parent().addClass("item-current");
                            var n = $(this.hash),
                                i = $(".js__pr-scrollbar").outerHeight() + 15,
                                t = this.hash.slice(1);
                            if (u = 1, n = $(`.js__li-${t}`), t === "ldp-location-insight" && (n = $(`.js__ldp-location-insight`)), n.length) return $("html, body").animate({
                                scrollTop: n.offset().top - i
                            }, 1e3, "easeInOutExpo", function() {
                                u = 0
                            }), !1
                        }
                    });
                    let n = $(".js__ldp-pricing-cta");
                    n.length > 0 && n.click(function() {
                        $(".js__pr-scrollbar a[href='#pricing-history-chart']").trigger("click")
                    });
                    let t = $(".js__ldp-location-insight-img-navigate");
                    t.length > 0 && t.click(function() {
                        c()
                    });
                    let i = $(".js__ldp-location-insight-navigate");
                    i.length > 0 && i.click(function() {
                        c()
                    })
                }

                function p() {
                    let i = new URL(document.location).searchParams,
                        r = i.get("source"),
                        u = i.get("adid"),
                        f = $(".tracking-sponsored");
                    if (u && r && r === "ad" && f.length === 0) {
                        var t = new Image(1, 1);
                        t.src = `${n.adbutlerAPI}convtrack.spark?MID=${n.adbutlerConfig.MID}&plid=${u}`;
                        t.className = "tracking-sponsored";
                        document.body.append(t)
                    }
                }

                function w(n, i) {
                    var r = {
                        classContent: `new2021 form-col-1`,
                        classHeader: "modal-header",
                        title: n,
                        width: 464,
                        url: a + i,
                        type: "GET",
                        keepBodyScroll: !1
                    };
                    t.ShowDialog(r)
                }

                function b() {
                    function u(n) {
                        if (r && f) {
                            var t = r.offsetHeight;
                            t > n && (f.scrollTop += t - n)
                        }
                    }
                    var e = 20,
                        f, r;
                    (function s() {
                        --e;
                        window.userServices ? window.userServices.getCurrentUserInfo(function(n) {
                            n && (n.mobile && $("#userMobile").val(n.mobile), n.email && $("#userEmail").val(n.email), n.name && $("#userFullName").val(n.name), o = n.userid)
                        }) : e >= 0 && setTimeout(s, 100)
                    })();
                    $(`.${t.GetStyleClass("tab-box--sm")}`).click(function() {
                        $(`.${t.GetStyleClass("tab-box--sm")}`).closest(`.js__pr-feedback-form`).find(`.${t.GetStyleClass("tab-box--sm")}`).removeClass(t.GetStyleClass("tab-box--actived"));
                        $(this).addClass(t.GetStyleClass("tab-box--actived"));
                        var n = $(this).data("tab");
                        $(".js__tab").hide();
                        $(".js__tab-" + n).show()
                    });
                    const n = $("#userMobile"),
                        i = $("#userEmail");
                    f = document.querySelector(".js__pr-feedback-container");
                    r = document.querySelector(".js__pr-feedback-form");
                    n.blur(function() {
                        var f = n.val().trim(),
                            e = i.val().trim(),
                            o = !r ? 0 : r.offsetHeight;
                        if (!f) e ? t.RemoveErrorMessage(n) : (t.AddErrorMessage(n, "Bạn cần nhập số điện thoại hoặc email"), u(o));
                        else {
                            if (e || t.RemoveErrorMessage(i), f.length !== 10 || !t.IsPhoneNumber(f)) {
                                t.AddErrorMessage(n, "Số điện thoại nhập vào không đúng.");
                                u(o);
                                return
                            }
                            t.RemoveErrorMessage(n)
                        }
                    });
                    i.blur(function() {
                        var f = n.val().trim(),
                            e = i.val().trim(),
                            o = !r ? 0 : r.offsetHeight;
                        if (!e) f ? t.RemoveErrorMessage(i) : (t.AddErrorMessage(i, "Bạn cần nhập số điện thoại hoặc email"), u(o));
                        else {
                            if (f || t.RemoveErrorMessage(n), !t.IsEmail(e)) {
                                t.AddErrorMessage(i, "Email không hợp lệ");
                                u(o);
                                return
                            }
                            t.RemoveErrorMessage(i)
                        }
                    });
                    $("input,textarea").blur(function() {
                        $(this).val(($(this).val() || "").trim())
                    })
                }

                function f(n, i) {
                    var r = `
                          <div class="sending_img">
                              <img src="${s}/images/contacts/not-send.svg">
                          </div>
                          <div class="sending_code">Thất bại</div>
                          <div class="sending_msg">${n}</div>`,
                        u;
                    i && (r = `
                          <div class="sending_img">
                              <img src="${s}/images/contacts/sent.svg">
                          </div>
                          <div class="sending_code">Gửi thành công</div>
                          <div class="sending_msg">${n}</div>`);
                    u = {
                        classContent: `new2021 form-col-1 static`,
                        classHeader: "modal-header",
                        style: "static",
                        title: `<div class="title"></div>`,
                        content: r,
                        width: 344,
                        keepBodyScroll: !1,
                        buttons: [{
                            text: "OK",
                            id: "btnCancel",
                            "class": t.GetStyleClass("btn", "btn-pr-solid--md"),
                            eventHandle: function() {
                                t.ModalEvent($("#dialogPopup"), "hide")
                            }
                        }, ]
                    };
                    t.ShowDialog(u)
                }

                function k(r) {
                    var v, c, a;
                    if (t.AddEventLoading($(`.js__submit-loading`)), !i) {
                        i = !0;
                        v = !0;
                        v = t.ValidateMobileAndEmail($("#userMobile"), $("#userEmail"));
                        v || (i = !1, t.RemoveEventLoading());
                        var y = 0,
                            e = "",
                            u = "",
                            s = "";
                        if ($(`.${t.GetStyleClass("tab-box--sm")}[data-tab=info]`).hasClass(t.GetStyleClass("tab-box--actived")) ? (y = 1, s = "info") : $(`.${t.GetStyleClass("tab-box--sm")}[data-tab=stats]`).hasClass(t.GetStyleClass("tab-box--actived")) ? (y = 2, s = "stats") : $(`.${t.GetStyleClass("tab-box--sm")}[data-tab=map]`).hasClass(t.GetStyleClass("tab-box--actived")) && (y = 3, s = "map"), $(".js__tab-" + s + " input[type=checkbox]:checked").each(function() {
                                e = e + $(this).val() + ". ";
                                u = u + $(this).val() + ";"
                            }), $(".js__tab-" + s + " input[type=checkbox]").change(function() {
                                $(".js__reported-issues").hide()
                            }), c = $(".js__tab-" + s + " textarea").val().trim() + "", e.trim() || c.trim() || ($(".js__reported-issues").html("Bạn cần chọn hoặc nhập phản hồi"), $(".js__reported-issues").show(), i = !1, t.RemoveEventLoading()), !v || !e.trim() && !c.trim()) {
                            e.trim() || c.trim() ? v || $("#userEmail").focus() : $(".js__reported-issues").focus();
                            return
                        }
                        try {
                            ga("send", "event", "ProductDetail", "Feedback", "Gửi phản hồi tin rao")
                        } catch (p) {}
                        a = t.GetCurrentBrowser();
                        $.ajax({
                            url: "https://api.ipify.org?format=jsonp&callback=?",
                            dataType: "jsonp"
                        }).done(function(s) {
                            var v = {
                                productId: +$("." + l.detailsProduct).attr("prid"),
                                type: y,
                                content: e + ". " + c,
                                email: $("#userEmail").val(),
                                mobile: $("#userMobile").val(),
                                name: $("#userFullName").val().trim(),
                                productUrl: t.GetUrlWithoutDuplicate(window.location.href),
                                etag: $("#popup-etag").val(),
                                token: r,
                                agent: navigator.userAgent,
                                referrer: document.referrer.indexOf(location.host) >= 0 ? undefined : document.referrer,
                                browser: `${a.os} ${a.osVersion} | ${a.browser} ${a.browserMajorVersion} (${a.browserVersion})`,
                                userId: o,
                                ip: s.ip
                            };
                            t.AjaxWrapper({
                                url: n.urlSubmitFeedback,
                                type: "POST",
                                data: v,
                                "async": !1,
                                success: function(n) {
                                    if (i = !1, n.success) {
                                        u = u.trim();
                                        u = u.length > 0 ? u.substring(0, u.length - 1) : u;
                                        var r = +window.dataLayer[0].ite;
                                        h.BadReportOrUnBadReportProduct(r, u, c).then(function(n) {
                                            n.isReport ? ($("#product-detail-web .pr-title").addClass("badReport"), h.ProcessTitle($("#product-detail-web .pr-title"), $("#product-detail-web .pr-title")), $(".js__bad-report").hide(), $(".js__bad-report-recur").show(), $(".js__item-more-report").addClass(`${t.GetStyleClass("off")}`), t.ModalEvent($("#dialogPopup"), "hide"), f(`Chúng tôi đã nhận được báo cáo của bạn và sẽ xử lý sớm nhất có thể.`, !0)) : (t.ModalEvent($("#dialogPopup"), "hide"), $(".js__item-more-report").removeClass(`${t.GetStyleClass("off")}`), f(`Lỗi hệ thống khi gửi, vui lòng thực hiện lại.`, !1))
                                        })
                                    } else n.type === "err_mobile" ? t.AddErrorMessage($("#userMobile"), "Số điện thoại nhập vào không đúng.") : n.type === "err_system" && (t.ModalEvent($("#dialogPopup"), "hide"), $(".js__item-more-report").removeClass(`${t.GetStyleClass("off")}`), f(`Lỗi hệ thống khi gửi, vui lòng thực hiện lại.`, !1));
                                    t.RemoveEventLoading()
                                },
                                error: function(n) {
                                    console.error(n);
                                    t.ModalEvent($("#dialogPopup"), "hide");
                                    $(".js__item-more-report").removeClass(`${t.GetStyleClass("off")}`);
                                    f(`Lỗi hệ thống khi gửi, vui lòng thực hiện lại.`, !1);
                                    t.RemoveEventLoading()
                                }
                            })
                        })
                    }
                }
                var t = new CommonJS.Common,
                    o = 0,
                    i = !1,
                    s = $("#staticDomain").data("cssserver"),
                    l = JSON.parse($("script[info-params]").attr("info-params")),
                    a = $("#staticDomain").data("msvrouter") !== undefined ? $("#staticDomain").data("msvrouter") : "",
                    e = new window.FrontEnd.MarkingProductsServices,
                    h = new window.FrontEnd.BadReportProductsServices,
                    u;
                return function() {
                    v();
                    y();
                    $(window).trigger("scroll");
                    $("[element-id='product-share']").click(function() {
                        $("[element-id='box-share']").slideToggle()
                    });
                    $(document).mousedown(function(n) {
                        $(n.target).hasClass("product-share") || $(n.target).parents(`[element-id='product-share']`).length > 0 || $(n.target).parents(`[element-id='box-share']`).length > 0 ? (n.preventDefault(), n.stopPropagation()) : $("[element-id='box-share']").is(":visible") && $("[element-id='box-share']").slideToggle()
                    });
                    $(".js__copyLink").click(function() {
                        t.CopyTextToClipboard(t.GetUrlWithoutDuplicate(window.location.href));
                        $(`[element-id='box-share']`).hide();
                        $(`.${t.GetStyleClass("tooltip-copy")}`).show().animate({
                            opacity: "1"
                        }, 1e3, "easeInOutQuint").delay(800).animate({
                            opacity: "0"
                        }, 2e3, "easeInOutQuint", function() {
                            $(this).css("display", "none")
                        })
                    });
                    $(".js__bad-report").click(function() {
                        w(`<div class="title">Báo cáo tin rao có thông tin không đúng</div>`, "/Product/ProductDetail/SendFeedback")
                    });
                    e.GetMarkedProducts().then(function(n) {
                        $(`.pr-info`).find(`.js__marking-product`).each(function(i, r) {
                            var u = $(r),
                                f = u.data("marked-product-info-as-json").productId,
                                e = u.data("marked-product-info-as-json").documentId;
                            n.filter(n => n.documentId != undefined ? n.documentId == e : n.productId == f).length ? (u.addClass(t.GetStyleClass("pressed")), u.attr("aria-label", u.data("aria-label-unsave")), $(".js__item-more-save").addClass(`${t.GetStyleClass("off")}`), $(".js__item-more-save .js__marking-product-details").attr("tracking-label") && $(".js__item-more-save .js__marking-product-details").attr("tracking-label", `${($(".js__item-more-save .js__marking-product-details").attr("tracking-label")+"").replace(",status=save","")},status=unsave`), u.attr("tracking-label") && u.attr("tracking-label", `${u.attr("tracking-label")},status=unsave`)) : ($(".js__item-more-save").removeClass(`${t.GetStyleClass("off")}`), $(".js__item-more-save .js__marking-product-details").attr("tracking-label") && $(".js__item-more-save .js__marking-product-details").attr("tracking-label", `${($(".js__item-more-save .js__marking-product-details").attr("tracking-label")+"").replace(",status=unsave","")},status=save`), u.attr("tracking-label") && u.attr("tracking-label", `${u.attr("tracking-label")},status=save`))
                        })
                    });
                    $(".js__buttonMoreActions").click(function() {
                        $(this).closest(".js__popupMore").attr("class").indexOf("active") < 0 ? ($("body").addClass("in"), $(".js__popupMore").addClass("active"), $(".js__popupMore").removeClass("active-share")) : ($("body").removeClass("in"), $(".js__popupMore").removeClass("active"), $(".js__popupMore").removeClass("active-share"))
                    });
                    $(".js__closePopupMore").click(function() {
                        $(".js__text-title-more").html("Chức năng khác");
                        $("body").removeClass("in");
                        $(".js__popupMore").removeClass("active");
                        $(".js__popupMore").removeClass("active-share")
                    });
                    $(".js__btn_share").click(function() {
                        $(".js__text-title-more").html("Chia sẻ");
                        $(".js__popupMore").addClass("active-share")
                    });
                    $(".js__share-back").click(function() {
                        $(".js__text-title-more").html("Chức năng khác");
                        $(".js__popupMore").removeClass("active-share")
                    });
                    $(`.pr-info`).find(`.js__marking-product`).click(function(n) {
                        n.stopPropagation();
                        n.preventDefault();
                        var i = $(this).data("marked-product-info-as-json");
                        i.url = location.href;
                        i != undefined && i.documentId != null ? e.MarkOrUnmarkProduct(i).then(function(n) {
                            var r;
                            if ($btns = $(`[data-marked-product-info-as-json*="${i.documentId}"]`), n.marked)
                                for ($btns.addClass(t.GetStyleClass("pressed")), $btns.attr("aria-label", $btns.data("aria-label-unsave")), $(".js__item-more-save").addClass(`${t.GetStyleClass("off")}`), r = 0; r < $btns.length; r++) $btn = $($btns[r]), $btn.attr("tracking-label") && $btn.attr("tracking-label", `${($btn.attr("tracking-label")+"").replace(",status=save","")},status=unsave`);
                            else
                                for ($btns.removeClass(t.GetStyleClass("pressed")), $btns.attr("aria-label", $btns.data("aria-label-save")), $(".js__item-more-save").removeClass(`${t.GetStyleClass("off")}`), r = 0; r < $btns.length; r++) $btn = $($btns[r]), $btn.attr("tracking-label") && $btn.attr("tracking-label", `${($btn.attr("tracking-label")+"").replace(",status=unsave","")},status=save`);
                            menu.UpdateMarkedProductsCount();
                            menu.ShowMarkedProductsPopup();
                            menu.ShowMarkedProductsNoti(n.marked)
                        }) : e.MarkOrUnmarkProduct(i).then(function(n) {
                            var r;
                            if ($btns = $(`[data-marked-product-info-as-json*=":${i.productId},"]`), n.marked)
                                for ($btns.addClass(t.GetStyleClass("pressed")), $btns.attr("aria-label", $btns.data("aria-label-unsave")), $(".js__item-more-save").addClass(`${t.GetStyleClass("off")}`), r = 0; r < $btns.length; r++) $btn = $($btns[r]), $btn.attr("tracking-label") && $btn.attr("tracking-label", `${($btn.attr("tracking-label")+"").replace(",status=save","")},status=unsave`);
                            else
                                for ($btns.removeClass(t.GetStyleClass("pressed")), $btns.attr("aria-label", $btns.data("aria-label-save")), $(".js__item-more-save").removeClass(`${t.GetStyleClass("off")}`), r = 0; r < $btns.length; r++) $btn = $($btns[r]), $btn.attr("tracking-label") && $btn.attr("tracking-label", `${($btn.attr("tracking-label")+"").replace(",status=unsave","")},status=save`);
                            menu.UpdateMarkedProductsCount();
                            menu.ShowMarkedProductsPopup();
                            menu.ShowMarkedProductsNoti(n.marked)
                        })
                    })
                }(), u = 0, $(".hidden-phone, .js__phone-event, .js__zalo-chat").click(function() {
                    p()
                }), {
                    SendFeedback: function(n) {
                        k(n)
                    },
                    PopupFeedbackEvents: b
                }
            } : setTimeout(function() {
                t(n)
            }, 100)
        })(n.Details || (n.Details = {}))
    })(n.Product || (n.Product = {}))
})(window.FrontEnd || (window.FrontEnd = {}));