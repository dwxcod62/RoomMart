(function(n) {
    (function(n) {
        (function t(n) {
            if (window.jQuery && window.Swiper && window.FrontEnd && window.FrontEnd.CardController && window.FrontEnd.ListingHistoryServices) {
                const t = 6,
                    i = 12;

                function r(n, r) {
                    let u = n.filter(n => r.length == 0 || !r.includes(n));
                    if (u.length > i) u = u.slice(0, i);
                    else if (u.length < t && r.length > 0) {
                        const i = n.filter(n => r.includes(n));
                        for (let n = 0; n < i.length; n++) {
                            if (u.length == t) break;
                            const r = i[n];
                            u.push(r)
                        }
                    }
                    return {
                        activeSuggestionProductIds: u
                    }
                }

                function u(n) {
                    function t() {
                        var t = $("#staticDomain").data("msvrouter") !== undefined ? $("#staticDomain").data("msvrouter") : "";
                        return new Promise(i => {
                            n.getListingRecommendationUrl && n.getListingRecommendationParams ? (n.getListingRecommendationParams.resultAsJson = !0, $.ajax({
                                type: "POST",
                                url: t + n.getListingRecommendationUrl,
                                data: n.getListingRecommendationParams
                            }).then(n => {
                                i(n)
                            })) : i({
                                impresstonListings: [],
                                recommendationType: ""
                            })
                        })
                    }
                    return t().then(t => {
                        if (t.impresstonListings && t.impresstonListings.length) {
                            const u = t.impresstonListings.map(n => n.productId),
                                f = (new window.FrontEnd.ListingHistoryServices).GetListingHistoryFromCache(n.getListingRecommendationParams.productId).map(n => n.productId),
                                e = r(u, f);
                            let i = t.impresstonListings.filter(n => e.activeSuggestionProductIds.indexOf(n.productId) >= 0);
                            i.length > 0 && cm.AddDataLayer({
                                event: "eec.impression",
                                ecommerce: {
                                    impressions: i
                                }
                            })
                        } else $(".js__similar-listing").hide();
                        t.recommendationType && cm.AddDataLayer({
                            event: "ldpRecommendationType",
                            type: t.recommendationType
                        })
                    }), {}
                }
                n.SimilarListing = u
            } else setTimeout(function() {
                t(n)
            }, 100)
        })(n.Details || (n.Details = {}))
    })(n.Product || (n.Product = {}))
})(window.FrontEnd || (window.FrontEnd = {}));