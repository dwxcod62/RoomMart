function clickImage360(n) {
    var u, i, t, f, e, r;
    $("#divPhoto360Active").contents(":not(.top-controls)").remove();
    $(n).siblings("li").removeClass("current");
    $(n).addClass("current");
    u = -10;
    $("#divPhoto360Active").hasClass("full-screen") && (u = 0);
    i = $(n).children("img");
    t = i.attr("full");
    t.indexOf("http://") == 0 && (t = t.replace("http://", "https://"));
    f = i.attr("title");
    e = $(n).attr("data-order");
    $("#titImg360").text(f);
    viewer = pannellum.viewer("divPhoto360Active", {
        panorama: t,
        autoLoad: !0,
        showControls: !1,
        compass: !0,
        northOffset: 0,
        orientationOnByDefault: !0
    });
    viewer.id = "viewer" + e;
    r = !1;
    $.each(viewers, function(n, t) {
        $(t).attr("id") == viewer.id && (r = !0)
    });
    r || viewers.push(viewer);
    viewer.on("load", function() {
        $(".pnlm-compass").removeClass("pnlm-controls");
        $(".pnlm-compass").removeClass("pnlm-control");
        $(".pnlm-compass").html('<i class="icon-deg360"><\/i>');
        $(".pnlm-compass").after('<div class="control-img360"><i class="icon-scan360"><\/i><\/div>')
    })
}

function onResize(n, t) {
    var i = n.height,
        r = n.width;
    setInterval(function() {
        (n.height !== i || n.width !== r) && (i = n.height, r = n.width, t())
    }, 300)
}

function detectIE() {
    var n = window.navigator.userAgent,
        i = n.indexOf("MSIE "),
        u, r, t;
    return i > 0 ? parseInt(n.substring(i + 5, n.indexOf(".", i)), 10) : (u = n.indexOf("Trident/"), u > 0) ? (r = n.indexOf("rv:"), parseInt(n.substring(r + 3, n.indexOf(".", r)), 10)) : (t = n.indexOf("Edge/"), t > 0) ? parseInt(n.substring(t + 5, n.indexOf(".", t)), 10) : !1
}
var viewers = [],
    mySwipers = [],
    isTablet = !1,
    iOS = !1;
$(function() {
    var t, n;
    if ((/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent) || /Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.platform)) && (isTablet = !0, iOS = ["iPad", "iPhone", "iPod"].indexOf(navigator.platform) >= 0), !isTablet && (t = '<div class="not-supported-browser">', t += "Trình duyệt bạn đang sử dụng không hỗ trợ tính năng này. Vui lòng nâng cấp lên phiên bản mới nhất để xem được ảnh 360.", t += "<\/div>", n = detectIE(), n && n < 10)) {
        $("#titImg360").before(t);
        return
    }
    if (n = detectIE(), n && n < 10) {
        $("#titImg360").before(t);
        return
    }
    $("#divPhoto360Active").length != 0 && ($(".thumbs360 li").bind("click", this, function() {
        clickImage360(this)
    }), document.getElementById("pan-up").addEventListener("click", function() {
        viewer.stopAutoRotate();
        viewer.setPitch(viewer.getPitch() + 10)
    }), document.getElementById("pan-down").addEventListener("click", function() {
        viewer.stopAutoRotate();
        viewer.setPitch(viewer.getPitch() - 10)
    }), document.getElementById("pan-left").addEventListener("click", function() {
        viewer.stopAutoRotate();
        viewer.setYaw(viewer.getYaw() - 10)
    }), document.getElementById("pan-right").addEventListener("click", function() {
        viewer.stopAutoRotate();
        viewer.setYaw(viewer.getYaw() + 10)
    }), document.getElementById("zoom-in").addEventListener("click", function() {
        viewer.stopAutoRotate();
        viewer.setHfov(viewer.getHfov() - 10)
    }), document.getElementById("zoom-out").addEventListener("click", function() {
        viewer.stopAutoRotate();
        viewer.setHfov(viewer.getHfov() + 10)
    }), document.getElementById("auto-rotate").addEventListener("click", function() {
        var n = viewer.getConfig();
        n && n.autoRotate ? viewer.stopAutoRotate() : viewer.startAutoRotate(-5)
    }), document.getElementById("fullscreen").addEventListener("click", function() {
        if ($.each(viewers, function(n, t) {
                t.toggleFullscreen()
            }), $("#divPhoto360Active .pnlm-render-container canvas").length) {
            var n = $("#divPhoto360Active .pnlm-render-container canvas")[0];
            onResize(n, function() {
                n.width === window.innerWidth && n.height === window.innerHeight ? $("#divPhoto360Active").addClass("full-screen") : $("#divPhoto360Active").removeClass("full-screen")
            })
        }
    }), document.getElementById("btnCloseFullscreen").addEventListener("click", function() {
        $.each(viewers, function(n, t) {
            t.toggleFullscreen()
        });
        $("#divPhoto360Active").removeClass("full-screen")
    }))
});